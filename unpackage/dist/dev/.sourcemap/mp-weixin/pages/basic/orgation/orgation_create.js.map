{"version":3,"sources":["uni-app:///main.js","webpack:///D:/MyRepository/EasySmartData/code/AftersveClientApp/pages/basic/orgation/orgation_create.vue?c086","webpack:///D:/MyRepository/EasySmartData/code/AftersveClientApp/pages/basic/orgation/orgation_create.vue?bfb1","webpack:///D:/MyRepository/EasySmartData/code/AftersveClientApp/pages/basic/orgation/orgation_create.vue?c110","webpack:///D:/MyRepository/EasySmartData/code/AftersveClientApp/pages/basic/orgation/orgation_create.vue?e302","uni-app:///pages/basic/orgation/orgation_create.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,yH;AACAA,UAAU,CAACC,wBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAA4H;AAC5H;AACmE;AACL;;;AAG9D;AAC0L;AAC1L,gBAAgB,2LAAU;AAC1B,EAAE,qFAAM;AACR,EAAE,0FAAM;AACR,EAAE,mGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,8FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,8OAEN;AACP,KAAK;AACL;AACA,aAAa,sTAEN;AACP,KAAK;AACL;AACA,aAAa,oVAEN;AACP,KAAK;AACL;AACA,aAAa,sTAEN;AACP,KAAK;AACL;AACA,aAAa,4WAEN;AACP;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACrDA;AAAA;AAAA;AAAA;AAA+tB,CAAgB,+rBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACmFnvB;AACA,+H;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAVA;;;;;;;;IASA;AACA;AACA,U,eACA,EACA,IADA,kBACA,CACA,SACA;AACA,oBAFA,EAEA;AACA,wBAHA,EAGA;AACA;AACA,qBALA,EAKA;AACA,kDANA,EAMA;AACA,yCAPA,EAOA;AACA,2CARA,EAQA;AACA,0BATA,EASA;AACA,oBAVA,EAUA;AACA,uBAXA,EAWA;AACA,mBAZA,EAYA;AACA;AACA,6BAdA,EAcA;AACA,iBACA,WADA,EACA;AACA,iBAFA,EAEA;AACA,gBAHA,EAGA;AACA,qBAJA,EAIA;AACA,oBALA,EAKA;AACA,iBANA,EAMA;AACA,iBAPA,EAOA;AACA,iBARA,EAQA;AACA,mBATA,CASA;AATA,OAfA,EAyBA;AACA,cA1BA,EA0BA;AACA,eACA,SACA,UACA,cADA,EAEA,qBAFA,GADA,EADA,EAOA,QACA,UACA,cADA,EAEA,qBAFA,GADA,EAPA,EAaA,WACA,UACA,cADA,EAEA,uBAFA,GADA,EAbA,EA3BA,CA8CA;AA9CA,MAiDA,CAnDA,EAoDA,6BACA,qCACA,CAtDA,EAuDA,kCACA,aACA,wBAFA,CAEA;AACA,4BAHA,CAGA;AAEA;AACA,yBANA,CAMA;AACA,4BAPA,CAOA;AACA,wBARA,CAQA;AACA,GAhEA,EAiEA,WACA;AACA;;OAGA,SALA,qBAKA,OALA,EAKA,CACA,6EADA,CACA;AACA,6EAFA,CAEA;AACA,KARA,EASA;AACA;;OAGA,8CACA,uCACA,qBACA;AACA,oCACA,CAHA,MAGA,CACA;AACA,kCACA,CACA,CAtBA,EAuBA;;;yCAIA,kDACA,8CACA,CA7BA,EA8BA;;+IAGA,sCACA,oCACA,CAnCA,EAoCA;;+NAGA,oCACA,mCACA,CAzCA,EA0CA;;4SAGA,+CACA,qCACA,CA/CA,EAiDA;;sYAGA,mCACA,uBACA,sDACA,kCAHA,CAIA;AACA,sEACA,gEACA,gEACA,CA5DA,EA6DA;;4MAGA,0CACA,sCACA,CAlEA,EAmEA;;;kSAIA,4BACA,gCADA,CACA;AACA;AACA,uBACA,yBADA,IAGA,CA7EA;AA8EA;AACA;;;AAGA,iBAlFA,yBAkFA,KAlFA,EAkFA;AACA;AACA;AACA;AACA,sCADA;AAEA,sBAFA;;AAIA;AACA;AACA,KA3FA;AA4FA;;;;AAIA,UAhGA,kBAgGA,IAhGA,EAgGA;AACA;AACA,YADA;AAEA,UAFA,CAEA;AACA;AACA;AACA,OALA;AAMA,WANA,CAMA;AACA;AACA,OARA;AASA,KA1GA;AA2GA;AACA;;;AAGA,iBA/GA,2BA+GA;AACA;AACA;AACA,mDADA;AAEA;AACA,gDADA,EAFA;;AAKA,qBALA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAFA;AAGA;AACA;AACA;AACA,SAnBA;AAoBA;AACA;AACA;AACA,SAvBA;AAwBA,wCAxBA;;AA0BA,KA3IA;AA4IA;;;AAGA,oBA/IA,8BA+IA;AACA;AACA,qDADA;AAEA;AACA,gDADA,EAFA;;AAKA,qBALA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BADA;AAEA,8BAFA;;AAIA;AACA,aATA,MASA;AACA;AACA;AACA;AACA,WAdA,MAcA;AACA;AACA;AACA;AACA,SAzBA;AA0BA;AACA;AACA,SA5BA;AA6BA,wCA7BA;;;AAgCA,KAhLA;AAiLA;;;AAGA,gBApLA,0BAoLA;AACA;AACA,+CADA;AAEA;AACA,gDADA,EAFA;;AAKA,qBALA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BADA;AAEA,8BAFA;;AAIA;AACA,aATA,MASA;AACA;AACA;AACA;AACA,WAdA,MAcA;AACA;AACA;AACA;AACA,SAzBA;AA0BA;AACA;AACA,SA5BA;AA6BA,wCA7BA;;AA+BA,KApNA;AAqNA;;;AAGA,gBAxNA,0BAwNA;AACA;AACA;AACA,sDADA;AAEA;AACA,gDADA,EAFA;;AAKA,2BALA;AAMA,sBANA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EADA,CACA;AACA,eAFA,MAEA;AACA,0DADA,CACA;AACA;AACA;AACA;AACA,6BADA;AAEA,+CAFA;AAGA,iCAHA;AAIA;AACA;AACA;AACA,gEADA;;AAGA;AACA,iBAVA;;AAYA,aAtBA,MAsBA;AACA;AACA;AACA;AACA,6BADA;AAEA,sCAFA;AAGA,iCAHA;AAIA;AACA;AACA;AACA,+CADA;;AAGA;AACA,iBAVA;;AAYA,aAfA,MAeA;AACA;AACA;AACA,4CADA;AAEA,4BAFA;;AAIA;AACA,WA7CA,MA6CA;AACA;AACA,8BADA;AAEA,0BAFA;;AAIA;AACA,SA5DA;AA6DA;AACA;AACA;AACA,+BADA;AAEA,wBAFA;;AAIA,SAnEA;AAoEA,wCApEA;;;AAuEA,KAjSA,EAjEA,E","file":"pages/basic/orgation/orgation_create.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/basic/orgation/orgation_create.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./orgation_create.vue?vue&type=template&id=bc45fc34&\"\nvar renderjs\nimport script from \"./orgation_create.vue?vue&type=script&lang=js&\"\nexport * from \"./orgation_create.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/basic/orgation/orgation_create.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orgation_create.vue?vue&type=template&id=bc45fc34&\"","var components\ntry {\n  components = {\n    isLogin: function() {\n      return import(\n        /* webpackChunkName: \"components/is-login/is-login\" */ \"@/components/is-login/is-login.vue\"\n      )\n    },\n    uniForms: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-forms/components/uni-forms/uni-forms\" */ \"@/uni_modules/uni-forms/components/uni-forms/uni-forms.vue\"\n      )\n    },\n    uniFormsItem: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-forms/components/uni-forms-item/uni-forms-item\" */ \"@/uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.vue\"\n      )\n    },\n    luyjSelectLay: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/luyj-select-lay/components/luyj-select-lay/luyj-select-lay\" */ \"@/uni_modules/luyj-select-lay/components/luyj-select-lay/luyj-select-lay.vue\"\n      )\n    },\n    uniDataPicker: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-data-picker/components/uni-data-picker/uni-data-picker\" */ \"@/uni_modules/uni-data-picker/components/uni-data-picker/uni-data-picker.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orgation_create.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orgation_create.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"flex flex-direction bg-white\">\r\n\t\t<!-- 是否登录 -->\r\n\t\t<is-login v-if=\"isLoginShow\" :currentPage=\"currentPage\" ></is-login>\r\n\t\t<!-- 导航栏 -->\r\n\t\t<cu-custom bgColor=\"bg-cyan\" :isBack=\"preview\">\r\n\t\t\t<block slot=\"content\">创建组织</block>\r\n\t\t</cu-custom>\r\n\t\t\r\n\t\t<uni-forms :rules=\"rules\" :value=\"current\" ref=\"form\" validate-trigger=\"bind\" err-show-type=\"undertext\">\r\n\t\t\t<view class=\"cu-form-group solid-bottom\">\r\n\t\t\t\t<view class=\"title text-bold\"> 是否分店</view>\r\n\t\t\t\t<switch @change=\"change_isBranch\" v-model=\"organtion_branch\" class=\"cyan\"\r\n\t\t\t\t\t:class=\"organtion_branch?'checked':''\" :checked=\"organtion_branch?true:false\"></switch>\r\n\t\t\t</view>\r\n\t\t\t<!-- 所属组织 -->\r\n\t\t\t<uni-forms-item  v-if=\"organtion_branch\" name=\"parentId\">\r\n\t\t\t\t<view class=\"cu-form-group solid-bottom\">\r\n\t\t\t\t\t<view class=\"title text-bold\" style=\"width: 180rpx;\">所属组织</view>\r\n\t\t\t\t\t<luyj-select-lay style=\"width: 100%;\" :loading=\"mearchLoading\" zindex=\"3\" name=\"name\" placeholder=\"请选择所属组织\" :options=\"organ_list\"\r\n\t\t\t\t\t       :value=\"current.parentId\" slabel=\"label\" svalue=\"MchId\" @selectitem=\"changeParent\">\r\n\t\t\t\t\t </luyj-select-lay>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"mchNo\" :border=\"true\">\r\n\t\t\t\t<view class=\"cu-form-group solid-bottom\">\r\n\t\t\t\t\t<view class=\"title text-bold\">{{ organtion_branch ? '分店代码':'组织代码' }}</view>\r\n\t\t\t\t\t<input :placeholder=\"organtion_branch? '请输入分店代码':'请输入组织代码'\" name=\"mchNo\" \r\n\t\t\t\t\t\t@input=\"changeMchNo($event);binddata('mchNo', $event.detail.value,'form')\"></input>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"name\">\r\n\t\t\t\t<view class=\"cu-form-group solid-bottom\">\r\n\t\t\t\t\t<view class=\"title text-bold\">{{ organtion_branch ? '分店名称':'组织名称' }}</view>\r\n\t\t\t\t\t<input :placeholder=\"organtion_branch? '请输入分店名称' :'请输入组织名称'\" name=\"name\" \r\n\t\t\t\t\t\t@input=\"changeName($event);binddata('name', $event.detail.value,'form')\"></input>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<!-- 所属行业：总部 -->\r\n\t\t\t<uni-forms-item v-if=\"!organtion_branch\" name=\"industryId\">\r\n\t\t\t\t<view class=\"cu-form-group solid-bottom\">\r\n\t\t\t\t\t<view class=\"title text-bold\">所属行业</view>\r\n\t\t\t\t\t<uni-data-picker placeholder=\"请选择行业\" style=\"width: 75%;\" :value=\"current.industryId\" :preload=\"true\" :localdata=\"industry_list\"\r\n\t\t\t\t\t\tpopup-title=\"请选择行业\" @nodeclick=\"changeIndustry\" ></uni-data-picker>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<uni-forms-item name=\"area\">\r\n\t\t\t\t<view class=\"cu-form-group solid-bottom\">\r\n\t\t\t\t\t<view class=\"title text-bold\">所在地区</view>\r\n\t\t\t\t\t<uni-data-picker ref=\"area\" placeholder=\"请选择地区\" style=\"width: 75%;\"  :value=\"area\" :preload=\"true\" :localdata=\"area_list\"\r\n\t\t\t\t\t\tpopup-title=\"请选择地区\" @nodeclick=\"nodeArea\" name=\"area\"></uni-data-picker>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<view class=\"cu-form-group\">\r\n\t\t\t\t<view class=\"action title text-bold\">\r\n\t\t\t\t\t详细地址\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<uni-forms-item name=\"address\">\r\n\t\t\t\t<view class=\"cu-form-group solid-bottom\">\r\n\t\t\t\t\t<textarea maxlength=\"-1\" placeholder=\"请输入详细地址\" name=\"address\"  \r\n\t\t\t\t\t\t@input=\"changeAddress($event);binddata('address', $event.detail.value,'form')\"></textarea>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-forms-item>\r\n\t\t</uni-forms>\r\n\t\t<button class=\"margin padding-lg bg-cyan cu-btn round\" @click=\"create('form')\">创建</button>\r\n\t\t<!-- 跳过此步骤 -->\r\n\t\t<navigator v-if=\"currentPage != 'index'\" url=\"\" class=\"flex flex-direction\" @tap=\"toSkip\" >\r\n\t\t\t<button class=\"margin padding-lg bg-grey cu-btn round\" >跳过此步骤</button>\r\n\t\t</navigator>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t/**\r\n\t * @description 创建组织\r\n\t * @author 陆彦捷\r\n\t * @date 2021.06.07 基本功能完成\r\n\t * @date 2021.07.01 令行业和范围可以不选择到子级\r\n\t * @date 2021.07.07 跳过此步骤\r\n\t * @date 2021.07.08 跳过创建/加入组织方法改为本地缓存\r\n\t * @date 2021.07.19 所属组织：包含缓存属性\r\n\t */\r\n\timport organ from '@/common/storage/organstorage.js'; // 组织\r\n\timport changeobj from '@/common/function/changeobjectecordname.js'; // 格式化值\r\n\tvar _self;\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\t// 样式有关参数\r\n\t\t\t\tpreview: false, // 是否进入上一页\r\n\t\t\t\tisLoginShow : false, // 验证登录控件启用\r\n\t\t\t\t// 系统有关参数\r\n\t\t\t\tcurrentPage : '',\t// 当前页面\r\n\t\t\t\tMchId : organ.getIndustryId(),\t\t// 获取当前组织id\r\n\t\t\t\tToken : this.global.login.getToken(), // 获取Token\r\n\t\t\t\tUserId : this.global.login.getUserId(), // 获取UserId\r\n\t\t\t\tmearchLoading: false,\t\t// 组织是否加载中\r\n\t\t\t\torgan_list: [], // 组织信息\r\n\t\t\t\tindustry_list: [], // 行业信息\r\n\t\t\t\tarea_list: [], // 区域信息列表\r\n\t\t\t\t// 提交数据\r\n\t\t\t\torgantion_branch: false, // 是否分店\r\n\t\t\t\tcurrent: {\r\n\t\t\t\t\tparentId: 0, // 所属组织\r\n\t\t\t\t\tmchNo: '', // 组织机构代码\r\n\t\t\t\t\tname: '', // 名称(组织/分店名称)\r\n\t\t\t\t\tindustryId: 0, // 所属行业Id\r\n\t\t\t\t\tareacode : \"\",\t// 所在地区code\r\n\t\t\t\t\tarea1: \"\", // 所在地区1\r\n\t\t\t\t\tarea2: \"\", // 所在地区2\r\n\t\t\t\t\tarea3: \"\", // 所在地区3\r\n\t\t\t\t\taddress: '' // 地址\r\n\t\t\t\t}, // 当前表单值\r\n\t\t\t\tarea : \"\" ,\t\t\t// 所在地区值\r\n\t\t\t\trules: {\r\n\t\t\t\t\tmchNo: {\r\n\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\terrorMessage: '请输入代码'\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t},\r\n\t\t\t\t\tname: {\r\n\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\terrorMessage: '请输入名称'\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t},\r\n\t\t\t\t\taddress: {\r\n\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\t\terrorMessage: '请输入详细地址'\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t}\r\n\t\t\t\t}, // 表单规则(行业和所在地区不验证)(组织暂时不验证)\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tonReady: function() {\r\n\t\t\tthis.$refs.form.setRules(this.rules);\r\n\t\t},\r\n\t\tonLoad: function(options) {\r\n\t\t\t_self = this;\r\n\t\t\tthis.getParams(options);\t// 获取参数\r\n\t\t\tthis.isLoginShow = true;\t// 启用验证登录控件\r\n\r\n\t\t\t// 请求基本信息\r\n\t\t\tthis.organ_request(); // 请求组织信息\r\n\t\t\tthis.industry_request(); // 请求行业信息\r\n\t\t\tthis.area_request();\t// 请求地区信息\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// ========================================== 初始化 ===================================================\r\n\t\t\t/** 获取传参\r\n\t\t\t * @param {Object} options\r\n\t\t\t */\r\n\t\t\tgetParams(options) {\r\n\t\t\t\tthis.preview = options.preview != 'false' ? Boolean(options.preview): false; // 是否绑定上一页\r\n\t\t\t\tthis.currentPage = options.currentPage ? options.currentPage : 'index';\t\t // 当前页面属性\r\n\t\t\t},\r\n\t\t\t// ========================================== 监听事件 ===================================================\r\n\t\t\t/** 判断是否 分店\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\tchange_isBranch : function(e) {\r\n\t\t\t\tthis.organtion_branch = e.detail.value;\r\n\t\t\t\tif(e.detail.value){\r\n\t\t\t\t\t// 是分店（清除行业值）\r\n\t\t\t\t\tthis.current.industryId = 0;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t// 不是分店（清除所属组织）\r\n\t\t\t\t\tthis.current.parentId = 0;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/** 修改所属组织\r\n\t\t\t * @param {Object} index 索引\r\n\t\t\t * @param {Object} item 当前项目\r\n\t\t\t */\r\n\t\t\tchangeParent: function(index, item) {\r\n\t\t\t\tthis.current.parentId = item ? item.MchId : 0;\r\n\t\t\t},\r\n\t\t\t/** 修改组织代码\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\tchangeMchNo : function(e){\r\n\t\t\t\tthis.current.mchNo = e.detail.value;\r\n\t\t\t},\r\n\t\t\t/** 修改名称\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\tchangeName : function(e){\r\n\t\t\t\tthis.current.name = e.detail.value;\r\n\t\t\t},\r\n\t\t\t/** 修改行业 （点击行业选项时触发）\r\n\t\t\t * @param {Object} item\r\n\t\t\t */\r\n\t\t\tchangeIndustry : function(item) {\r\n\t\t\t\tthis.current.industryId = item.value;\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t/** 点击所在地区时(触发修改当前地区)\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\tnodeArea : function(item){\r\n\t\t\t\tthis.area = item.value;\r\n\t\t\t\tvar selectedArray = this.$refs['area'].$data.selected;\r\n\t\t\t\tvar length = selectedArray.length;\r\n\t\t\t\t// 分别获取area1、area2、area3的值\r\n\t\t\t\tthis.current.area1 = length > 0 ? selectedArray[0].value : null;\r\n\t\t\t\tthis.current.area2 = length > 1 ? selectedArray[1].value : null;\r\n\t\t\t\tthis.current.area3 = length > 2 ? selectedArray[2].value : null;\r\n\t\t\t},\r\n\t\t\t/** 修改地址\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\tchangeAddress : function(e){\r\n\t\t\t\tthis.current.address = e.detail.value;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 跳过此步骤\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\ttoSkip : function(e){\r\n\t\t\t\tthis.global.login.setSkipTrue();\t// 设置跳过此步骤为true\r\n\t\t\t\t// 跳转到主页\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl :'/pages/index/index'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//==================================== 提交并验证 ==============================================\r\n\t\t\t/** 表单验证失败执行方法\r\n\t\t\t * @param {Object} erros\r\n\t\t\t */\r\n\t\t\tmessage_erros(erros) {\r\n\t\t\t\t// 验证手机号、验证码验证失败\r\n\t\t\t\tif (erros.length > 0) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: erros[0].errorMessage,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 创建组织\r\n\t\t\t * @param {String} form 表单名称\r\n\t\t\t */\r\n\t\t\tcreate(form) {\r\n\t\t\t\tthis.$refs[form]\r\n\t\t\t\t\t.submit()\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t// 表单验证成功，创建组织\r\n\t\t\t\t\t\t_self.organ_create();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(errors => {\r\n\t\t\t\t\t\t_self.message_erros(errors);\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// ========================================== 请求方法 ====================================================\r\n\t\t\t/**\r\n\t\t\t * 请求所有组织机构\r\n\t\t\t */\r\n\t\t\torgan_request() {\r\n\t\t\t\tthis.mearchLoading = true;\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: _self.website + '/api/SvcMerchant/Get',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\tAuthorization: 'Bearer ' + _self.Token\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t\t_self.mearchLoading = false;\r\n\t\t\t\t\t\tconsole.log(\"请求组织机构success=>\",result);\r\n\t\t\t\t\t\tif (result.statusCode == 200) {\r\n\t\t\t\t\t\t\tif (result.data.ResultCode == \"0\") {\r\n\t\t\t\t\t\t\t\tvar data = result.data.Data;\r\n\t\t\t\t\t\t\t\t_self.organ_list = data;\r\n\t\t\t\t\t\t\t\t_self.organ_list.forEach(item=>{\r\n\t\t\t\t\t\t\t\t\titem.label = item.Name + '(' + item. MchNo +')';\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}  \r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(erros) {\r\n\t\t\t\t\t\t_self.mearchLoading = false;\r\n\t\t\t\t\t\tconsole.log(\"请求组织机构fail=>\",erros);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: function() {}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 请求所有行业\r\n\t\t\t */\r\n\t\t\tindustry_request() {\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: _self.website + '/api/Share/GetIndustry',\r\n\t\t\t\t\theader: {\r\n\t\t\t\t\t\tAuthorization: 'Bearer ' + _self.Token\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t\tif (result.statusCode == 200) {\r\n\t\t\t\t\t\t\tif (result.data.ResultCode == \"0\") {\r\n\t\t\t\t\t\t\t\tvar data = result.data.Data;\r\n\t\t\t\t\t\t\t\t_self.industry_list = changeobj.change(data,\"IndustryId\",\"Name\",\"Children\");\r\n\t\t\t\t\t\t\t\t// 为行业添加\"全部范围\"\r\n\t\t\t\t\t\t\t\tvar tempIndustry = {\r\n\t\t\t\t\t\t\t\t\t\"value\": 0,\r\n\t\t\t\t\t\t\t\t\t\"text\": \"全部范围\",\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t_self.industry_list.unshift(tempIndustry);\r\n\t\t\t\t\t\t\t}  else {\r\n\t\t\t\t\t\t\t\t// 返回结果错误\r\n\t\t\t\t\t\t\t\tconsole.log(\"返回错误结果\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// 连接失败\r\n\t\t\t\t\t\t\tconsole.log(\"连接失败\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(erros) {\r\n\t\t\t\t\t\tconsole.log(erros);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: function() {}\r\n\t\t\t\t});\r\n\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 请求所有地区\r\n\t\t\t */\r\n\t\t\tarea_request() {\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: _self.website + '/api/Share/Areas',\r\n\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\tAuthorization: 'Bearer ' + _self.Token\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmethod: 'GET',\r\n\t\t\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t\t\tif (result.statusCode == 200) {\r\n\t\t\t\t\t\t\t\tif (result.data.ResultCode == \"0\") {\r\n\t\t\t\t\t\t\t\t\tvar data = result.data.Data;\r\n\t\t\t\t\t\t\t\t\t_self.area_list = changeobj.change(data,\"code\",\"name\",\"Children\");\r\n\t\t\t\t\t\t\t\t\t// 为地区添加\"全部范围\"\r\n\t\t\t\t\t\t\t\t\tvar tempArea = {\r\n\t\t\t\t\t\t\t\t\t\t\"value\": \"\",\r\n\t\t\t\t\t\t\t\t\t\t\"text\": \"全部范围\",\r\n\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t_self.area_list.unshift(tempArea);\r\n\t\t\t\t\t\t\t\t}  else {\r\n\t\t\t\t\t\t\t\t\t// 返回结果错误\r\n\t\t\t\t\t\t\t\t\tconsole.log(\"返回错误结果\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// 连接失败\r\n\t\t\t\t\t\t\t\tconsole.log(\"连接失败\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(erros) {\r\n\t\t\t\t\t\t\tconsole.log(erros);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcomplete: function() {}\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 创建组织 / 分店\r\n\t\t\t */\r\n\t\t\torgan_create() {\r\n\t\t\t\t\tuni.showLoading();\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: _self.website + '/api/SvcMerchant/Create',\r\n\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\tAuthorization: 'Bearer ' + _self.Token\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdata: _self.current,\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\tif (result.statusCode == 200) {\r\n\t\t\t\t\t\t\t\tif (result.data.ResultCode == \"0\") {\r\n\t\t\t\t\t\t\t\t\tvar data = result.data.Data;\r\n\t\t\t\t\t\t\t\t\t// 保存当前mchId\r\n\t\t\t\t\t\t\t\t\tconsole.log(\"返回的组织信息=> \",data , _self.current.parentId );\r\n\t\t\t\t\t\t\t\t\tif(_self.current.parentId != 0 && _self.MchId == 0){\r\n\t\t\t\t\t\t\t\t\t\torgan.setIndustryId(_self.current.parentId);\t\t// 设置当前组织\r\n\t\t\t\t\t\t\t\t\t}else if(_self.MchId == 0) {\r\n\t\t\t\t\t\t\t\t\t\torgan.setIndustryId(data);\t\t// 设置当前组织\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t// 创建成功\r\n\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\ttitle:'创建成功',\r\n\t\t\t\t\t\t\t\t\t\tcontent:'创建组织/分店成功。点击确认进入引导页。',\r\n\t\t\t\t\t\t\t\t\t\tshowCancel:false,\r\n\t\t\t\t\t\t\t\t\t\tsuccess: (result) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif(result.confirm){\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\turl: '/pages/basic/page_guid?preview=true' \r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else if (result.data.ResultCode == \"401\") {\r\n\t\t\t\t\t\t\t\t\t// 清除当前消息，并重新登录\r\n\t\t\t\t\t\t\t\t\t_self.global.login.clearloginMessage();\r\n\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '登录过期',\r\n\t\t\t\t\t\t\t\t\t\tcontent: '登录过期，请重新登录。',\r\n\t\t\t\t\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\t\t\t\t\tsuccess: function(result) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (result.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\turl: '/pages/login/login'\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// 其他错误\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: result.data.ResultMsg,\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '数据连接失败！',\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(erros) {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: erros.errMsg,\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcomplete: function() {}\r\n\t\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"],"sourceRoot":""}